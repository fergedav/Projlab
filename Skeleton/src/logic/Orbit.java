package logic;

import java.util.ArrayList;
import java.util.List;

public abstract class Orbit implements java.io.Serializable {
    /**
     *
     */
    private static final long serialVersionUID = 8842665086008545927L;
    /**
     * szomszédokat tartalmazó lista
     */
    protected List<Orbit> neighbours;
    /**
     * a rajta álló travelereket tartalmazó lista
     */
    protected List<Traveler> travelers;
    /**
     * megmondja, hogy az orbit napfényben van-e.
     */
    protected boolean inLight = false;
    /**
     * az orbit kérge
     */
    protected int layers = 0;
    /**
     * az orbit x koordinátája
     */
    protected int x; 
    /**
     * az orbit y koordinátája
     */
    protected int y;
    /**
     * prefix az adott orbit azonosítására
     */
    String prefix;
    /**
    * konstruktor, létrehozza a szomszédok, és travelerek listáját.
    */
    protected Orbit() {
        neighbours = new ArrayList<Orbit>();
        travelers = new ArrayList<Traveler>();
        
    }

    /**
     * Virtuális függvény. 
     * Hozzáadja a paraméterként kapott Traveler-t az Orbit travelers listájához és visszatér önmagával.
     * @param t érkezett traveler
     * @return saját maga
     */
    public Orbit addTraveler(Traveler t)
    {
        travelers.add(t);
        return this;
    }


    /**
     * Visszatér az Orbiton jelenleg tartózkodó utazók listájával
     * @return Orbiton jelenleg tartózkodó utazók
     */
    public List<Traveler> getTravelers()
    {
        return travelers;
    }

    /**
     * Eltávolítja a paraméterként kapott Traveler-t az Orbit travelers listájából.
     * @param t Traveler
     */
    public void removeTraveler(Traveler t)
    {
        travelers.remove(t);
    }

    /**
     * A paraméterként kapott Orbit-ot hozzáadja a szomszédsági listájához.
     * @param o Orbit
     */
    public Orbit addNeighbour(Orbit o)
    {
        neighbours.add(o);
        return this;
    }

    /**
     * Kitörli a paraméterként kapott Orbitot az objektum szomszédsági listájából.
     * @param o Orbit
     */
    public void removeNeighbour(Orbit o)
    {
        neighbours.remove(o);
    }

    /**
     * Visszatér az orbit i-edik szomszédjával. Ha i-edik szomszéd nem létezik null-t ad vissza.
     * @param i szomszéd sorszáma
     * @return szomszédos Orbit
     */
    public Orbit getNeighbour(int i)
    {
        try 
        {
            Orbit o = neighbours.get(i);
            return o;
        } 
        catch (Exception e) 
        {
            return this;
        }

        
    }

    public abstract void drilled();

    /**
     * visszadja a tartalmazott nyersanyagot
     * @return Resource 
     */
    public Resource retrieveResource()
    {
        return null;
    }

    /**
     * Virtuális függvény. Alapértelmezésben false-t ad vissza.
     * @param r
     * @return
     */
    public boolean putResource(Resource r)
    {
        return false;
    }

    /**
     * Alapértelmezésben meghívja a travelers listája összes elemére a Die() függvényt.
     */
    public void sunstormArrive(int[] coords )
    {
        if(!(
            coords[0] <= x &&
            coords[1] <= y &&
            coords[2] >= x &&
            coords[3] >= y
        )) return;

        ArrayList<Traveler> copy = new ArrayList<>();
        copy.addAll(travelers);
        for (Traveler t : copy) {
            t.die();
        }
    }

    /**
     * Eldönti, hogy a koordinátái alapján beleesik-e a jelzett négyzetbe. 
     * Ha igen, akkor beállítja true-ra a inLight attribútumot, ha nem beállítja false-ra.
     * @param int[] coords 
     */
    public void sunLightArrive(int[] coords )
    {

        if( coords[0] <= x &&
            coords[1] <= y &&
            coords[2] >= x &&
            coords[3] >= y)
        {
            inLight = true;
        }
        else
        {
            inLight = false;
        }

    }

    /**
     * Még nem átfurt rétegek száma
     * @return rétegek
     */
    public int getLayers()
    {
        return layers;
    }

    public int numOfNeighbor()
    {   
        return neighbours.size();
    }
    
    /**
     * Visszadja az orbit koordinantatit 
     * x,y kooridnata
     * @return [x,y]
     */
    public int[] getCoords()
    {
        int i[]= {x,y};
        return i;
    }
    /**
     * Visszadja az orbit aktualis napfeny allapotata 
     * @return boolean true, ha napfeny van
     */
    public boolean getLight()
    {
        return inLight;
    }    

    /**
     * Visszater az adott Orbithoz tartozo prefixxel
     * @return String prefix
     */
    public String getPrefix()
    {
        return prefix;
    }

    /**
     * alapértelmezett getter, az asteroid overrideolja
     * @return null
     */
    public Resource getCore()
    {
        return null;
    }

    /**
     * Egy másolt lista az Orbit szomszédairól
     * @return a lista
     */
    public List<Orbit> getNeighborList()
    {
        return new ArrayList<Orbit>(neighbours);
    }

    /**
     * kell a comboBox megjelenítéshez
     */
    @Override
    public String toString()
    {
        return prefix;
    }
}
